)
shootings_plot
content <- paste(sep = "<br/>",
"<num_injured",
"address",
"date"
)
content <- paste(sep = "<br/>",
"num_injured",
"address",
"date"
)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500
) %>%
addPopups(
lat = ~lat,
lng = ~long,
content,
options = popupOptions(closeButton = FALSE)
)
shootings_plot
content <- paste(sep = "<br/>",
~num_injured,
~address,
~date
)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500
) %>%
addPopups(
lat = ~lat,
lng = ~long,
content,
options = popupOptions(closeButton = FALSE)
)
shootings_plot
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(killed_df$num_killed, "people were killed in this shooting", "<br>",
"Var2: ", killed_df$city, "is the city where this shooting occurred", "<br>",
"Var3: ", killed_df$date, "was the date that the shooting occurred", "<br>")
)%>%
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting", "<br>",
"Var2: ", killed_df$city, "is the city where this shooting occurred", "<br>",
"Var3: ", killed_df$date, "was the date that the shooting occurred", "<br>")
)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting", "<br>",
"Var2: ", killed_df$city, "is the city where this shooting occurred", "<br>",
"Var3: ", killed_df$date, "was the date that the shooting occurred", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting", "<br>",
killed_df$city, "is the city where this shooting occurred", "<br>",
killed_df$date, "was the date that the shooting occurred", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
leaflet(shootings_plot)
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 2) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -122, zoom = 3) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -118, zoom = 3) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -110, zoom = 3) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -110, zoom = 4) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 47, lng = -100, zoom = 4) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 4) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 3.5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 3) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 3.2) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 3.3) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
shootings_plot <- leaflet(data = killed_df) %>%
addProviderTiles("CartoDB.Positron") %>%
setView(lat = 40, lng = -100, zoom = 3.5) %>%
addCircles(
lat = ~lat,
lng = ~long,
stroke = FALSE,
radius = ~num_killed * 10500,
popup = paste(
killed_df$num_killed, "people were killed in this shooting.", "<br>",
killed_df$city, "is the city where this shooting occurred.", "<br>",
killed_df$date, "was the date that the shooting occurred.", "<br>")
)
shootings_plot
question_plot <- ggplot(shootings_df, aes(as.Date(date)))
question_plot + geom_bar(aes(fill=num_killed), width = 0.5) +
theme(axis.text.x = element_text(angle=65, vjust=0.6)) +
labs(title="Categorywise Bar Chart",
subtitle="Manufacturer of vehicles",
caption="Source: Manufacturers from 'mpg' dataset")
question_plot <- ggplot(shootings_df, aes(months(date), num_killed))
question_plot + geom_bar(stat="identity", width = 0.5, fill="tomato2") +
labs(title="Bar Chart",
subtitle="Manufacturer of vehicles",
caption="Source: Frequency of Manufacturers from 'mpg' dataset") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
## plot
month <- format(date, "%m")
question_plot <- ggplot(shootings_df, aes(month, num_killed))
question_plot + geom_bar(stat="identity", width = 0.5, fill="tomato2") +
labs(title="Bar Chart",
subtitle="Manufacturer of vehicles",
caption="Source: Frequency of Manufacturers from 'mpg' dataset") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
month_df$month <- factor(month_df$month, levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
month_df <- shootings_df %>%
mutate(month = format(substr(date, 1, 3)))
month_df$month <- factor(month_df$month, levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
choice_plot <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
mode = "markers"
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot
choice_plot <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot
plot_ly(choice_plot)
plot_ly(choice_plot)
choice_plot <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot
choice_plot <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot
choice_plote <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plote
choice_plote <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
mode = "markers"
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plote
choice_plot_1 <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
mode = "markers"
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot_1
plot_ly(choice_plot_1)
choice_plot_1 <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
mode = "markers"
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot_1
choice_plot_1 <- plot_ly(
data = month_df,
x = ~month,
y = ~num_killed,
type = "bar",
mode = "markers"
) %>%
layout(
title = "Deadliest Month in 2018",
xaxis = list(title = "month"),
yaxis = list(title = "deaths")
)
choice_plot_1
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
source("analysis.R")
flextable(agg_sum)
shootings_plot
choice_plot_1
agg_sum = aggregate.data.frame(shootings_df[,5:6],by=list(shootings_df$state), FUN = sum, na.rm = TRUE)
agg_sum
agg_sum_df <- flextable(head(agg_sum))
agg_sum_df <- set_header_labels(agg_sum_df,
values = list(Group.1 = "State",
num_killed = "Number Killed",
num_injured = "Number Injured")
)
agg_sum_df <- set_header_labels(agg_sum_df,
values = list(Group.1 = "State",
num_killed = "Number Killed",
num_injured = "Number Injured")
)
agg_sum_df_labels <- set_header_labels(agg_sum_df,
values = list(Group.1 = "State",
num_killed = "Number Killed",
num_injured = "Number Injured")
)
agg_sum_df_labels
flextable(agg_sum_df_labels)
flextable(agg_sum_df_labels)
flextable(agg_sum_df_labels)
flextable(agg_sum_df)
flextable(agg_sum_df)
flextable(agg_sum)
agg_sum_df_labels <- set_header_labels(agg_sum_df,
values = list(Group.1 = "State",
num_killed = "Number Killed",
num_injured = "Number Injured")
)
agg_sum = aggregate.data.frame(shootings_df[,5:6],by=list(shootings_df$state), FUN = sum, na.rm = TRUE)
agg_sum
agg_sum = aggregate.data.frame(agg_sum_df_labels[,5:6],by=list(shootings_df$state), FUN = sum, na.rm = TRUE)
agg_sum
agg_sum = aggregate.data.frame(agg_sum_df_labels[,5:6],by=list(shootings_df$state), FUN = sum, na.rm = TRUE)
agg_sum
agg_sum_df <- flextable(head(agg_sum))
agg_sum_df_labels <- set_header_labels(agg_sum_df,
values = list(Group.1 = "State",
num_killed = "Number Killed",
num_injured = "Number Injured")
)
agg_sum_df_labels
agg_sum_df_labels
agg_sum_df_labels
agg_sum = aggregate.data.frame(shootings_df[,5:6],by=list(shootings_df$state), FUN = sum, na.rm = TRUE)
agg_sum
agg_sum
agg_sum_df_labels
flextable(agg_sum_df_labels)
flextable(agg_sum)
library(lintr)
lintr(analysis.R)
incident <- shootings_df %>%
filter(num_killed == max(num_killed))
library(lintr)
lint("analysis.R")
